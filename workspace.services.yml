services:
  workspace.manager:
    class: Drupal\workspace\WorkspaceManager
    arguments: ['@request_stack', '@entity_type.manager', '@current_user', '@logger.channel.workspace']
    tags:
      - { name: service_collector, tag: workspace_negotiator, call: addNegotiator }
  plugin.manager.workspace.upstream:
    class: Drupal\workspace\UpstreamPluginManager
    parent: default_plugin_manager
  workspace.replication_manager:
    class: Drupal\workspace\Replication\ReplicationManager
    tags:
      - { name: service_collector, tag: workspace_replicator, call: addReplicator }
  workspace.default_replicator:
    class: Drupal\workspace\Replication\DefaultReplicator
    arguments: ['@workspace.manager', '@entity_type.manager', '@database']
    tags:
      - { name: workspace_replicator, priority: 0 }
  workspace.negotiator.default:
    class: Drupal\workspace\Negotiator\DefaultWorkspaceNegotiator
    tags:
      - { name: workspace_negotiator, priority: 0 }
  workspace.negotiator.session:
    class: Drupal\workspace\Negotiator\SessionWorkspaceNegotiator
    arguments: ['@current_user', '@user.private_tempstore']
    tags:
      - { name: workspace_negotiator, priority: 100 }
  cache_context.workspace:
    class: Drupal\workspace\WorkspaceCacheContext
    arguments: ['@workspace.manager']
    tags:
      - { name: cache.context }
  logger.channel.workspace:
    parent: logger.channel_base
    arguments: ['cron']
